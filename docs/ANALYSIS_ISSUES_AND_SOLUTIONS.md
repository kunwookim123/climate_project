# 태양광 발전 분석 - 문제점 및 개선 방안

> **작성일**: 2025-11-11
> **프로젝트**: 기상 데이터와 태양광 발전량 상관관계 분석 (2020-2024)

---

## 📌 목차

1. [현재 프로젝트 상태](#1-현재-프로젝트-상태)
2. [발견된 문제점](#2-발견된-문제점)
3. [왜 문제인가?](#3-왜-문제인가)
4. [개선 방안](#4-개선-방안)
5. [구현 우선순위](#5-구현-우선순위)

---

## 1. 현재 프로젝트 상태

### ✅ 구현된 기능

```
✓ 기상 데이터 로딩 및 전처리 (2020-2024, 97개 지역, 174,829건)
✓ 강수량-발전량 산점도 시각화
✓ 장마철/비장마철 비교 지도 (10개 PNG)
✓ 지역별 발전량 인터랙티브 지도
✓ 키보드 네비게이션 분석 슬라이드
```

### 📊 현재 분석 결과

**기존 분석 주장**: "강수량이 증가하면 발전량이 감소한다"

```
강수량 구간별 평균 발전량:
├─ 0mm:      269.34 kWh
├─ 0.1-1mm:  253.25 kWh
├─ 1-10mm:   288.36 kWh ⬆️ 왜 더 높을까?
├─ 10-50mm:  292.37 kWh ⬆️ 더욱 높다?
└─ 50mm+:    183.75 kWh ⬇️ 폭우 시 급감
```

**🤔 이상한 점**: 비가 많이 올수록 발전량이 증가하다가 갑자기 감소?

---

## 2. 발견된 문제점

### 🚨 문제 1: 예측발전량이 일사량으로만 계산됨

**데이터 검증 결과**:
```python
# 예측발전량_PR고정 = 일사량 × 20.835 (상수)
발전량/일사량 비율 평균:      20.835030
발전량/일사량 비율 표준편차:   0.000009  ← 거의 0!

상관계수:
- 일사량 ↔ 발전량:  +1.000  ← 완벽한 선형관계
- 강수량 ↔ 발전량:  -0.085  ← 거의 영향 없음
```

**의미**:
- 예측발전량은 `일사량 × 상수`로 계산된 값
- 강수량은 발전량에 **직접적인 영향을 주지 않음**
- 단지 강수량이 일사량을 감소시켜 **간접적으로** 영향

---

### 🚨 문제 2: 계절 효과 혼재

**강수량 구간별 발생 계절 분석**:
```
강수량 구간    평균 발생 월    평균 일사량
───────────────────────────────────────
0mm           6.7월 (여름)   12.93 MJ/m²
0.1-1mm       6.5월 (여름)   12.16 MJ/m²
1-10mm        6.4월 (여름)   13.84 MJ/m² ⬆️
10-50mm       6.5월 (여름)   14.03 MJ/m² ⬆️
50mm+         7.2월 (장마)    8.82 MJ/m² ⬇️
```

**왜 1-50mm 구간의 발전량이 높을까?**
→ 여름철에는 비가 자주 오지만 **기본 일사량이 높기 때문**!

**착시 효과**:
```
❌ 잘못된 해석: "비가 10mm 오면 발전량이 증가한다"
✅ 올바른 해석: "10mm 비는 여름에 많이 내려서 일사량이 높은 시기와 겹침"
```

---

### 🚨 문제 3: 일사량 통제 없는 비교

**같은 일사량 조건에서 강수량 영향 확인**:
```
일사량을 15-17 MJ/m²로 고정했을 때:

강수량       발전량        차이
─────────────────────────────
0mm         329.01 kWh   기준
0.1-5mm     328.33 kWh   -0.2%
5-20mm      328.60 kWh   -0.1%
20mm+       327.26 kWh   -0.5%
```

**결론**: 일사량이 같으면 강수량과 무관하게 발전량이 거의 동일!

---

## 3. 왜 문제인가?

### ⚠️ 신뢰성 문제

현재 분석은 **인과관계를 잘못 해석**하고 있습니다:

```
현재 주장:    강수량 ──→ 발전량 ❌

실제 관계:    강수량 ──→ 일사량 ──→ 발전량 ✅
                          └→ 기온 ──→ PR효율
```

### 📉 실무적 한계

1. **정책 결정 오류 위험**
   - "비가 10mm 오면 발전량이 증가한다" → 잘못된 의사결정

2. **투자 판단 왜곡**
   - 장마철 손실을 과소/과대 평가 가능

3. **학술적 신뢰도 저하**
   - 동료 검토(peer review)에서 반려 가능성

---

## 4. 개선 방안

### 방안 1: PR가변 데이터 활용 ⭐ 추천

**분석 초점**: 강수량이 발전 효율(PR)에 미치는 영향

```python
# PR가변 데이터는 기온을 고려
PR 범위:      0.72 ~ 0.78
PR-기온 상관: -0.855  ← 기온이 높으면 효율 감소

분석 내용:
1. 강수일의 PR vs 비강수일의 PR 비교
2. 강수량 구간별 PR 변화
3. 기온 효과 통제 후 순수 강수량 영향
```

**장점**:
- 강수량의 실제 영향을 분리 가능
- 기온 효과를 고려한 현실적 분석

**구현 난이도**: 중 (기존 코드 수정)

---

### 방안 2: 경로 분석 (Mediation Analysis)

**분석 초점**: 강수량 → 일사량 → 발전량 간접 효과

```
Step 1: 강수량이 일사량을 얼마나 감소시키는가?
  - 회귀분석: 일사량 = f(강수량)
  - 예: 강수량 1mm 증가 → 일사량 X MJ/m² 감소

Step 2: 일사량 감소가 발전량에 미치는 영향
  - 발전량 = 일사량 × 20.835
  - 일사량 1 MJ/m² 감소 → 발전량 20.835 kWh 감소

Step 3: 총 효과 계산
  - 강수량 1mm → 발전량 (Step1 × Step2) kWh 감소
```

**장점**:
- 인과관계가 명확
- 학술적으로 타당한 방법론
- 계절 효과 통제 가능

**구현 난이도**: 중상 (새로운 분석 로직 필요)

---

### 방안 3: 장마철 경제적 손실 분석 ⭐ 실용적

**분석 초점**: 장마철의 실질적 발전량 손실 규모

```
분석 내용:
1. 장마철 vs 비장마철 평균 일사량 비교
   예: 장마철 9.8 MJ/m² vs 비장마철 15.2 MJ/m²

2. 일사량 감소에 따른 발전량 손실
   예: (15.2 - 9.8) × 20.835 = 112.5 kWh 손실/일

3. 지역별 손실 규모 비교
   - 남부: 장마 집중 → 높은 손실
   - 중북부: 상대적으로 적은 손실

4. 금액 환산
   - 전력 판매 단가 × 손실 kWh
   - 연간 총 손실액 계산
```

**장점**:
- 실무적으로 유용
- 이해하기 쉬움
- 의사결정에 직접 활용 가능

**구현 난이도**: 하 (기존 데이터로 바로 계산 가능)

---

### 방안 4: 일조시간 활용

**분석 초점**: 강수량과 일조시간의 관계

```
일조시간은 실측 데이터:
- 일사량: 복사 에너지 (MJ/m²)
- 일조시간: 햇빛이 비친 시간 (시간)

분석:
- 강수량 ↔ 일조시간 상관분석
- 일조시간 ↔ 발전량 관계
- 강수일의 일조시간 패턴
```

**장점**:
- 일조시간은 일사량과 독립적인 변수
- 강수량 영향을 다른 각도에서 검증

**구현 난이도**: 중

---

## 5. 구현 우선순위

### 🥇 1순위: 방안 3 (장마철 경제적 손실 분석)

**이유**:
- 가장 빠르게 구현 가능
- 실무적 가치가 높음
- 기존 시각화 재활용 가능

**예상 시간**: 1-2시간

---

### 🥈 2순위: 방안 1 (PR가변 데이터 활용)

**이유**:
- 더 현실적인 분석
- 기온 효과 고려
- 기존 코드 일부 수정으로 가능

**예상 시간**: 2-3시간

---

### 🥉 3순위: 방안 2 (경로 분석)

**이유**:
- 학술적으로 가장 타당
- 인과관계 명확히 규명
- 논문/보고서에 적합

**예상 시간**: 4-6시간

---

## 📝 다음 단계

### 즉시 실행 가능한 작업

1. **방안 3 구현**
   ```bash
   python -m src.analysis.monsoon_economic_impact
   ```
   - 장마철/비장마철 일사량 차이 계산
   - 발전량 손실 kWh 계산
   - 지역별 손실 지도 생성
   - 금액 환산 (단가 입력 필요)

2. **기존 분석 수정**
   - `rainfall_analysis.py`에 경고 메시지 추가
   - "이 분석은 계절 효과가 혼재되어 있음" 명시
   - 올바른 해석 가이드 추가

3. **문서화**
   - README에 분석의 한계점 명시
   - 올바른 해석 방법 가이드 작성

---

## 🔍 참고: 데이터 구조

### 기상 데이터 (`2020~2024.csv`)
```
컬럼: 지점, 지점명, 일시, 평균기온(°C), 일강수량(mm),
     평균 풍속(m/s), 합계 일조시간(hr), 합계 일사량(MJ/m2),
     평균 지면온도(°C)
```

### 발전량 데이터
- **PR고정** (`예측발전량_PR고정_수정.csv`)
  - 발전량 = 일사량 × 20.835
  - 강수량 영향 분석 **불가능**

- **PR가변** (`예측발전량_PR가변_수정.csv`)
  - PR이 기온에 따라 0.72~0.78 변동
  - PR-기온 상관: -0.855
  - 강수량 영향 분석 **가능** (기온 경로)

---

## ✅ 체크리스트

분석 시작 전 확인 사항:

- [ ] 분석 목표가 명확한가?
  - [ ] 강수량의 직접 효과? → PR가변 데이터 사용
  - [ ] 간접 효과 (일사량 경유)? → 경로 분석
  - [ ] 실무적 손실 규모? → 경제적 영향 분석

- [ ] 계절 효과를 통제하는가?
  - [ ] 같은 계절 내 비교
  - [ ] 또는 일사량/기온 변수 포함

- [ ] 인과관계를 정확히 표현하는가?
  - [ ] "강수량이 발전량을 감소" ❌
  - [ ] "강수량이 일사량을 감소시켜 발전량 감소" ✅

---

**최종 수정**: 2025-11-11
